(()=>{const{range:t}=rxjs,{map:e,filter:a}=rxjs.operators;function i(t){let e=String(t).split("."),a=e[0],i=e.length>1?"."+e[1]:"",o=/(\d+)(\d{3})/;for(;o.test(a);)a=a.replace(o,"$1 $2");return a+i}function o(){fetch("data.json").then((t=>t.json())).then((t=>{let e=t.goods,a=0,o="<tbody>",l=JSON.parse(localStorage.getItem("cart")),n=Object.keys(l).length;if(document.querySelector(".btnOpenCart .counter").textContent=n||0,n)for(s in l){let t=e[s];t&&(o+="<tr>",o+='<td data-label="Picture"><img src="upload/goods/'+t.alias+"/medium/"+t.preview.photo[0]+'" width="70" alt=""></td>',o+='<td data-label="Name">',o+="<h4>"+t.title+'<button type="button" class="btnDeleteCartGood ui float right" data-id="'+t.id+'" title="Удалить"><i class="icon x"></i></button></h4><p class="vendor_code">'+t.vendor_code+"</p>",o+='<div class="visible-sm">',o+='<div class="ui input number-spinner">',o+='<button type="button" class="number-spinner-button" data-dir="down"><i class="icon minus"></i></button>',o+='<input type="text" value="'+l[s]+'" data-id="'+t.id+'">',o+='<button type="button" class="number-spinner-button" data-dir="up"><i class="icon plus"></i></button>',o+="</div>",o+='<div><p class="price">'+i(t.prices.new)+" р.</p></div>",o+="</div>",o+="</td>",o+='<td data-label="Qty">',o+='<div class="ui input number-spinner">',o+='<button type="button" class="number-spinner-button" data-dir="down"><i class="icon minus"></i></button>',o+='<input type="text" value="'+l[s]+'" data-id="'+t.id+'">',o+='<button type="button" class="number-spinner-button" data-dir="up"><i class="icon plus"></i></button>',o+="</div>",o+="</td>",o+='<td data-label="Price"><p class="price">'+i(t.prices.new)+" р.</p></td>",o+='<td data-label="Action"><button type="button" class="btnDeleteCartGood" data-id="'+t.id+'" title="Удалить"><i class="icon x"></i></button></td>',o+="</tr>",a+=parseInt(t.prices.new)*l[s])}else o+='<tr><td colspan="5">Товаров в корзине нет</td></tr>';o+="</tbody>",document.querySelector("#cartModalTable").innerHTML=o,document.querySelector("#totalSum").innerText=i(a),document.querySelector("#submitCartForm").setAttribute("data-totalsum",a),document.querySelector(".btnOpenCart").setAttribute("data-tooltip","= "+i(a)+" р."),document.querySelector("#cartModal form input[name=goods]").value=JSON.stringify(l)})).catch((t=>{console.error("Request failed",t)}))}t(1,20).pipe(a((t=>t%2==1)),e((t=>t+t))).subscribe((t=>console.log(t)));class l{constructor(t){this.title=t}setTitle(){document.title=this.title}static getPage(){let t=location.pathname.substr(1).trim().replace(".html","");alert(t+" test")}}location.pathname.substr(1).trim().replace(".html","")||new l("Гигантские раскраски ilo").setTitle();const n={sd:"Самовывоз (Санкт-Петербург)","russian-post":"Почтой России",courier:"Бесконтактная курьерская доставка"};if(n&&document.getElementById("deliveryTypesForm")){let t='<div class="grouped fields">';for(var s in t+="<label>Выберите тип доставки</label>",n)t+='<div class="field"><div class="ui radio">',t+="sd"==s?'<label><input type="radio" name="delivery" value="'+s+'" checked> '+n[s]+"</label>":'<label><input type="radio" name="delivery" value="'+s+'"> '+n[s]+"</label>",t+="</div></div>";t+="</div>",document.getElementById("deliveryTypesForm").innerHTML=t}window.onload=()=>{let t=document.querySelectorAll("form");t&&t.forEach((t=>{t.insertAdjacentHTML("beforeEnd",'<input type="hidden" name="timezone" value="'+Intl.DateTimeFormat().resolvedOptions().timeZone+'">'),t.insertAdjacentHTML("beforeEnd",'<input type="hidden" name="user_city" value="'+ymaps.geolocation.city+'">'),t.insertAdjacentHTML("beforeEnd",'<input type="hidden" name="g-recaptcha-response" class="g-recaptcha-response" value="">')})),document.querySelector("form input[name=city]")&&(document.querySelector("form input[name=city]").value=ymaps.geolocation.city),document.querySelector("#cartModal form")&&document.querySelector("#cartModal form").insertAdjacentHTML("beforeEnd",'<input type="hidden" name="goods" value="">');let e=JSON.parse(localStorage.getItem("cart"))||{},a=Object.keys(e).length;a&&document.querySelector(".btnOpenCart .counter")&&(document.querySelector(".btnOpenCart .counter").textContent=a),fetch("data.json").then((t=>t.json())).then((t=>{let a=t.goods,o=0;for(s in e){let t=a[s];t&&e.hasOwnProperty(s)&&(o+=t.prices.new*e[s]),document.querySelector(".btnOpenCart")&&document.querySelector(".btnOpenCart").setAttribute("data-tooltip",`= ${i(o)} р.`)}let l='<div class="ui three stackable cards">',n=location.pathname.substr(1).trim().replace(".html","");for(var s in a){if(n&&n==a[s].alias&&!0===a[s].status){let t='<div class="ui stackable grid">';t+='<div class="seven wide column">',t+='<div class="image">',t+='<a data-lightbox="good" href="upload/goods/'+a[s].alias+"/large/"+a[s].images[0]+'">',t+='<img src="upload/goods/'+a[s].alias+"/medium/"+a[s].images[0]+'" class="ui fluid image" alt="">',t+="</a>",t+="</div>",t+="</div>",t+='<div class="nine wide column">',t+='<div class="description">',t+="<h4>"+a[s].title+"</h4>",t+='<p class="vendor_code">Артикул: '+a[s].vendor_code+"</p>",t+='<p class="prices"><span class="price">'+i(a[s].prices.new)+"р.</span>",a[s].prices.old&&(t+=' <span class="oldprice">'+i(a[s].prices.old)+"р.</span>"),t+="</p>",t+='<div style="margin-bottom: 20px;"><button class="ui yellow button addToCart" data-id="'+a[s].id+'" data-price="'+a[s].prices.new+'">Добавить в корзину</button></div>',t+="<div>"+a[s].text+"</div>",t+="</div>",t+="</div>",t+="</div>",document.querySelector("#good").innerHTML=t}if(n!=a[s].alias&&!0===a[s].status){let t=a[s].categories,e="";if(t)for(let a in t)e+=a+" ";l+='<div class="card '+e.trim()+'">',a[s].quantity&&(l+='<div class="ui label">Осталось<br> '+a[s].quantity+" шт</div>"),a[s].quantity||"Новинка"!=a[s].label||(l+='<div class="ui label label-new">'+a[s].label+"</div>"),a[s].quantity||"Выгоднее<br>на 1000р"!=a[s].label&&"Выгоднее<br>на 2000р"!=a[s].label||(l+='<div class="ui label">'+a[s].label+"</div>"),a[s].preview.photo[1]?l+='<div class="ui slide image reveal btnOpenGoodDetailsModal" data-id="'+a[s].id+'" data-link="/'+a[s].alias+'">':l+='<div class="ui image btnOpenGoodDetailsModal" data-id="'+a[s].id+'" data-link="/'+a[s].alias+'">',a[s].preview.photo&&(l+='<img src="upload/goods/'+a[s].alias+"/medium/"+a[s].preview.photo[0]+'" alt="'+a[s].title+'" class="visible content">',a[s].preview.photo[1]&&(l+='<img src="upload/goods/'+a[s].alias+"/medium/"+a[s].preview.photo[1]+'" alt="'+a[s].title+'" class="hidden content">')),l+="</div>",l+='<div class="content btnOpenGoodDetailsModal" data-id="'+a[s].id+'" data-link="/'+a[s].alias+'">',l+="<h3>"+a[s].title+"</h3>",l+='<div class="description">'+a[s].subtitle+"</div>",l+='<p class="prices"><span class="price">'+i(a[s].prices.new)+" р.</span>",a[s].prices.old&&(l+=' <span class="oldprice">'+i(a[s].prices.old)+"р.</span>"),l+="</p>",l+="</div>",l+='<div class="inline center">',l+='<button type="button" class="ui yellow button addToCart" data-id="'+a[s].id+' " data-price="'+a[s].prices.new+'">В корзину</button>',l+='<a href="/'+a[s].alias+'" class="ui basic black button btnOpenGoodDetailsModal" data-id="'+a[s].id+'">Подробнее</a>',l+="</div>",l+="</div>"}}l+="</div>",document.querySelector("#catalog")&&(document.querySelector("#catalog").innerHTML=l),document.querySelectorAll(".btnOpenGoodDetailsModal").forEach((t=>{t.addEventListener("click",(function(t){let e,a;t.preventDefault(),e=parseInt(this.dataset.id),a=this.getAttribute("href")||this.dataset.link,a?fetch("data.json").then((t=>t.json())).then((t=>{let a=t.goods,o=a[e];if(o&&!0===o.status){let t='<div class="ui stackable grid">';t+='<div class="seven wide column">',t+='<div class="image">',t+='<a data-lightbox="good" href="upload/goods/'+o.alias+"/large/"+o.images[0]+'">',t+='<img src="upload/goods/'+o.alias+"/medium/"+o.images[0]+'" class="ui fluid image" alt="">',t+="</a>",t+="</div>",t+="</div>",t+='<div class="nine wide column">',t+='<div class="description">',t+="<h4>"+o.title+"</h4>",t+='<p class="vendor_code">Артикул: '+o.vendor_code+"</p>",t+='<p class="prices"><span class="price">'+i(o.prices.new)+"р.</span>",o.prices.old&&(t+=' <span class="oldprice">'+i(o.prices.old)+"р.</span>"),t+="</p>",t+='<div style="margin-bottom: 20px;"><button class="ui yellow button addToCart" data-id="'+o.id+'" data-price="'+o.prices.new+'">Добавить в корзину</button></div>',t+="<p>"+o.text+"</p>",t+='<div><a href="/'+o.alias+'">Перейти на страницу товара</a></div>',t+="</div>",t+="</div>",t+="</div>",t+='<h2 style="margin-bottom: 20px;">Вас может заинтересовать:</h2>',t+='<div class="tiny-slider ui cards" id="goodsCarousel">';for(let o in a)o!=e&&1==a[o].status&&(t+='<div class="card">',a[o].preview.photo[1]?t+='<div class="ui slide reveal btnOpenGoodDetailsModal" data-id="'+a[o].id+'" data-link="/'+a[o].alias+'">':t+='<div class="ui">',a[o].preview.photo&&(t+='<img src="upload/goods/'+a[o].alias+"/medium/"+a[o].preview.photo[0]+'" width="100%" alt="'+a[o].title+'" class="visible content">',a[o].preview.photo[1]&&(t+='<img src="upload/goods/'+a[o].alias+"/medium/"+a[o].preview.photo[1]+'" width="100%" alt="'+a[o].title+'" class="hidden content">')),t+="</div>",t+='<div class="content btnOpenGoodDetailsModal" data-id="'+a[o].id+'" data-link="/'+a[o].alias+'">',t+="<h3>"+a[o].title+"</h3>",t+='<div class="description text-ellipsis">'+a[o].subtitle+"</div>",t+='<p class="prices"><span class="price">'+i(a[o].prices.new)+' р.</span> <span class="oldprice">'+i(a[o].prices.old)+" р.</span></p>",t+="</div>",t+='<div class="inline center">',t+='<button type="button" class="ui fluid yellow button addToCart" data-id="'+a[o].id+'" data-price="'+a[o].prices.new+'">В корзину</button>',t+="</div>",t+="</div>");t+="</div>",document.querySelector("#goodDetailsModal .modal-body").innerHTML=t,tns({container:"#goodsCarousel",gutter:0,items:4,slideBy:"page",controlsPosition:"bottom",controlsText:['<i class="chevron left icon"></i>','<i class="chevron right icon"></i>'],nav:!0,navPosition:"bottom",speed:300,autoplay:!1,autoplayTimeout:1500,loop:!0,responsive:{0:{items:1,nav:!1},480:{items:1,nav:!1},768:{items:3},970:{items:4}},lazyload:!1}),$("#goodDetailsModal").modal("show")}})).catch((t=>{console.log("Request failed",t)})):window.location.href=a}))}))})).catch((t=>{console.error("Request failed",t)}));const l=document.querySelector(".btnOpenCart");l&&(l.onclick=()=>{o(),$("#cartModal").modal("show")},l.oncontextmenu=()=>!1);const n={items:[{number:1,text:"Раскраска напечатана экологичными чернилами, которые не дают аллергических реакций"},{number:2,text:"Плотная бумага не рвется и не мнется"},{number:3,text:"Изображены рисунки без мелких деталей"}],generateHTML(){let t='<div class="ui stackable grid"><div class="three column row">';for(let e of this.items){let{number:a,text:i}=e;t+=`<div class="column">\n\t\t\t\t\t<div class="ui items">\n\t\t\t\t\t\t<div class="item">\n\t\t\t\t\t\t\t<div class="ui tiny">\n\t\t\t\t\t\t\t\t<div class="yellow_square"></div>\n\t\t\t\t\t\t\t\t<span>0${a}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="middle aligned content">\n\t\t\t\t\t\t\t\t<p>${i}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`}return t+="</div></div>",t}},s=document.querySelector(".triggers");s&&(s.innerHTML=n.generateHTML());const d=document.querySelectorAll(".filter li a");d&&d.forEach((function(t){t.addEventListener("click",(function(t){t.preventDefault(),document.querySelectorAll(".filter li").forEach((t=>t.classList.remove("active"))),this.parentElement.classList.add("active");let e=this.getAttribute("href").slice(1)||this.getAttribute("data-filter");"all"!=e?(document.querySelectorAll(".ui.cards>.card").forEach((t=>{t.style.display="none"})),document.querySelectorAll(".ui.cards>.card."+e).forEach((t=>{t.style.display="block"}))):document.querySelectorAll(".ui.cards>.card").forEach((t=>{t.style.display="block"}))}))}))},new SimpleLightbox('a[data-lightbox="gallery"]',{sourceAttr:"href",overlay:!0,spinner:!0,nav:!0,navText:["←","→"],captions:!0,captionSelector:"img",captionType:"attr"}),document.querySelector("#reviewTinySlider")&&tns({container:"#reviewTinySlider",gutter:80,edgePadding:0,items:3,slideBy:"page",controlsPosition:"bottom",controlsText:['<i class="chevron left icon"></i>','<i class="chevron right icon"></i>'],nav:!0,navPosition:"bottom",speed:300,autoplay:!1,autoplayTimeout:1500,loop:!0,responsive:{0:{items:1,nav:!1},480:{items:1,nav:!1},768:{items:2},970:{items:3}},lazyload:!0}),document.body&&document.querySelectorAll(".addToCart")&&document.body.addEventListener("click",(function(t){if(t.target&&t.target.classList.contains("addToCart")){t.target.disabled=!0;let e=parseInt(t.target.dataset.id),a=parseFloat(t.target.dataset.price);if(e){let t=JSON.parse(localStorage.getItem("cart"))||{};t.hasOwnProperty(e)?t[e]+=1:t[e]=1,localStorage.setItem("cart",JSON.stringify(t))}o(),$("#cartModal").modal("show"),"undefined"!=typeof fbq&&fbq("track","AddToCart",{value:a,currency:"RUB",content_type:"product",content_ids:String(e)}),t.target.disabled=!1,console.clear()}})),document.body&&document.querySelectorAll(".number-spinner-button")&&document.body.addEventListener("click",(function(t){if(t.target&&t.target.classList.contains("number-spinner-button")){let e=Array.from(t.target.parentNode.children).filter((e=>e!==t.target&&"INPUT"==e.tagName));if(e){let a=parseInt(e[0].value.trim()),i=0,l=e[0].dataset.id;if(i="up"==t.target.dataset.dir?parseInt(a)+1:a>=1?parseInt(a)-1:1,a>=1&&0==i)document.querySelector('.btnDeleteCartGood[data-id="'+l+'"]').click();else{e[0].value=i;let t=JSON.parse(localStorage.getItem("cart"))||{};t[l]=i,localStorage.setItem("cart",JSON.stringify(t)),o()}}}})),document.body&&document.querySelectorAll(".btnDeleteCartGood")&&document.body.addEventListener("click",(function(t){if(t.target&&t.target.classList.contains("btnDeleteCartGood")){if(t.target.setAttribute("disabled","disabled"),1==window.confirm("Вы уверены, что хотите удалить товар из корзины")){let e=parseInt(t.target.dataset.id);if(e){let t=JSON.parse(localStorage.getItem("cart"))||{};delete t[e],localStorage.setItem("cart",JSON.stringify(t)),o(),$("#cartModal").modal("show")}}t.target.removeAttribute("disabled")}})),document.querySelector(".btnCloseGoodDetailsModal")&&(document.querySelector(".btnCloseGoodDetailsModal").onclick=()=>{$("#goodDetailsModal").modal("hide")});const d=document.querySelectorAll(".lazy"),r=new IntersectionObserver((t=>{t.forEach((t=>{t.intersectionRatio>0&&(t.target.src=t.target.getAttribute("data-src"))}))}),{root:null,rootMargin:"0px",threshold:.1});d.forEach((t=>{r.observe(t)}));let c=document.getElementsByClassName("scroll-btn-link");if(c)for(let t of c)t.onclick=function(t){t.preventDefault();let e=t.target.dataset.target||this.getAttribute("href");e&&$("body, html").animate({scrollTop:$(e).offset().top},1e3)};let u=parseInt(!!(p=(p=window.location.search).match(new RegExp("order_id=([^&=]+)")))&&p[1]);var p;u&&new Promise(((t,e)=>{var a=new XMLHttpRequest;a.open("GET","/info.php?order_id="+u,!0),a.onload=function(){if(this.status>=200&&this.status<400){let e=JSON.parse(this.response);t(e);let a=location.pathname.trim().substr(1);if("thanks"!=a&&(document.getElementById("paymentOrderId").value=e.id,"prepay"==a?(document.getElementById("paymentDescription").value="Предоплата за заказ №"+e.id,document.getElementById("paymentSum").value=e.delivery.cost):(document.getElementById("paymentDescription").value="Оплата заказа №"+e.id,document.getElementById("paymentSum").value=e.sum)),document.getElementById("paymentDetails")){let t='<div class="ui segment">';if(t+="<div>",t+="<h3>Детали заказа:</h3>",t+="<ul>",t+="<li>",t+="<span>Номер заказа:</span>",t+="<span>№"+e.id+"</span>",t+="</li>",t+="<li>",t+="<span>ФИО плательщика:</span>",t+="<span>"+e.fullname+"</span>",t+="</li>",t+="</ul>",t+="</div>",e.items){t+="<div>",t+="<h3>Состав заказа:</h3>",t+="<ul>";for(let a=0;a<e.items.length;a++)t+="<li>",t+="<span>"+e.items[a].title+"<br>("+e.items[a].quantity+"ш. "+e.items[a].selling_price+"р.)</span>",t+="<span>"+e.items[a].quantity*e.items[a].selling_price+" руб.</span>",t+="</li>";t+="<li>",t+="<span>Доставка<br>"+e.delivery.cost+" руб</span>",t+="</li>",t+="<li>",t+="<span><b>ИТОГО</b></span>",t+="<span>"+e.sum+" руб.</span>",t+="</li>",t+="</ul>",t+="</div>"}t+="<div>",t+="<h3>Адрес доставки:</h3>",t+="<p>"+e.delivery.fulladdress+"</p>",t+="</div>",t+="</div>",document.getElementById("paymentDetails").innerHTML=t}}},a.onerror=()=>{console.error("something went wrong")},a.send()})).then((t=>t.created_at)).then((t=>{console.log("Order created at",t)})).catch((t=>{console.log(t)})),document.querySelector("#cartProcessForm")&&document.querySelector("#cartProcessForm").addEventListener("submit",(function(t){let e=parseFloat(document.querySelector("#submitCartForm").dataset.totalsum);document.querySelector("#cartModal form input[name=goods]").value,fbq("track","Purchase",{value:e,currency:"RUB",content_type:"product"}),document.querySelector("#submitCartForm").disabled=!0}));let m=document.querySelector(".scrollToTopBtn"),v=document.documentElement;m&&(m.addEventListener("click",(function(t){t.preventDefault(),v.scrollTo({top:0,behavior:"smooth"})})),document.addEventListener("scroll",(function(){var t=v.scrollHeight-v.clientHeight;v.scrollTop/t>.8?m.style.display="block":m.style.display="none"}))),document.querySelectorAll(".include").forEach((t=>{fetch(t.dataset.file).then((t=>t.text())).then((e=>{t.innerHTML=e}))}));let y=document.getElementById("cartModalName");y&&(y.onkeypress=function(t){if(t.keyCode>=48&&t.keyCode<=57||this.value.length>100)return!1});const b=document.querySelectorAll('input[type="tel"]');b&&b.forEach((t=>{IMask(t,{mask:"+{7}(#00) 000-00-00",definitions:{"#":/[0-6|9]/},lazy:!1,placeholderChar:"_"})})),document.addEventListener("DOMContentLoaded",(function(){[].forEach.call(document.querySelectorAll("#delivery .ui.segment"),(function(t){t.addEventListener("click",(function(){document.querySelectorAll("#delivery .ui.segment").forEach((t=>{t.classList.remove("active")}));let t=this.dataset.index;this.classList.add("active"),document.querySelector("#deliverySlide").setAttribute("src","/upload/pages/delivery-"+t+".jpg")}))}))})),document.getElementById("submitCartForm"),document.getElementById("cartFormCheckbox");let g=document.getElementsByName("delivery");if(g)for(let t of g)t.onchange=function(){"sd"!=this.value?document.getElementById("addressFormInput").style.display="block":document.getElementById("addressFormInput").style.display="none"};if(document.getElementById("copyrightYear")){const t=(new Date).getFullYear(),e=document.getElementById("copyrightYear");e.style.color="black",e.innerHTML=t}document.getElementById("cartFormSelect")&&(document.getElementById("cartFormSelect").parentElement.style.display="none")})();
//# sourceMappingURL=bundle.js.map